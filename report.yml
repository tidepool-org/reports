jira:
  # these come from either .env or environment
  # base_url: https://tidepool.atlassian.net
  # username: travis-ci@tidepool.org
  # api_token: ...
  queries:
    requirements: project = TLFR AND issuetype = "Functional Requirement" AND (resolution IS EMPTY OR resolution NOT IN ("Cannot Reproduce", Duplicate, "Won't Do")) AND (component NOT IN (ExcludeFromReport) OR component IS EMPTY) ORDER BY issuekey ASC
    risks: project = TLR AND issuetype IN (Story, Task) AND (resolution IS EMPTY OR resolution NOT IN ("Cannot Reproduce", Duplicate, "Won't Do")) AND (component NOT IN (ExcludeFromReport) OR component IS EMPTY) ORDER BY issuekey ASC
    epics: project = LOOP AND fixVersion = "FDA 510(k) Sub" AND issuetype = "Epic" AND (resolution is EMPTY OR resolution NOT IN ("Cannot Reproduce", Duplicate, "Won't Do")) AND (component NOT IN (ExcludeFromReport) OR component is EMPTY) ORDER BY issuekey ASC
    stories: project = LOOP AND fixVersion = "FDA 510(k) Sub" AND issuetype IN (Story, Bug, Task, Sub-task) AND (resolution IS EMPTY OR resolution NOT IN ("Cannot Reproduce", Duplicate, "Won't Do")) AND "Epic Link" NOT IN (LOOP-496, LOOP-1501) AND (component NOT IN (ExcludeFromReport) OR component IS EMPTY) ORDER BY "Epic Link" ASC, issuekey ASC
    tests: project = LOOP AND issuetype IN ("Test") ORDER BY issuekey ASC
    testruns: project = LOOP AND issuetype IN ("Test Execution") ORDER BY issuekey ASC
  fields:
    epic_key: customfield_10014
    functional_requirements: customfield_10132
    done_criteria: customfield_10072
    test_strategy: customfield_10036
    reference_id: customfield_10140
    sequence_of_events: customfield_10144
    harm: customfield_10089
    hazard_category: customfield_10095
    initial_severity: customfield_10085
    initial_probability: customfield_10086
    initial_risk: customfield_10101
    residual_severity: customfield_10093
    residual_probability: customfield_10094
    residual_risk: customfield_10102
    benefit: customfield_10142

html:
  title: Tidepool Loop 1.0
  subject: Verification Test Report
  author: Tidepool Project
  manager: Tapani Otala
  company: Tidepool Project
  keywords: verification,test,report
  comments: Created with Python and atlassian-python-api and xlsxwriter
  images:
    splash: templates/images/Tidepool Loop + Watch + Pod - 002.png
    logo: templates/images/Tidepool_Logo_Light_Large.png
  templates:
    cover: templates/html/cover.html
    header: templates/html/header.html
    report: templates/html/report.html
    style: templates/html/report.css
  output:
    splash: output/Tidepool Loop + Watch + Pod - 002.png
    logo: output/Tidepool_Logo_Light_Large.png
    cover: output/cover.html
    header: output/header.html
    report: output/report.html
    style: output/report.css

pdf:
  input:
    cover: output/cover.html
    header: output/header.html
    report: output/report.html
  output:
    report: output/report.pdf

excel:
  title: Tidepool Loop 1.0
  subject: Reports for Regulatory Agency
  author: Tidepool Project
  manager: Tapani Otala
  company: Tidepool Project
  keywords: traceability,hazard,analysis,verification,test,report
  comments: Created with Python and atlassian-python-api and xlsxwriter
  paper_size: 5 # US Legal size
  margins: { left: 0.5, right: 0.5, top: 0.75, bottom: 0.5 }
  font_name: Helvetica Neue
  font_size: 10
  sheets:
    # sheet names max 31 characters
    cover:
      name: Cover
      splash:
        image: templates/excel/Tidepool Loop + Watch + Pod - 002.png
        x_scale: 0.65
        y_scale: 0.65
      introduction: |-

        This document is intended to show the detail of the Tidepool’s Quality Management System for Tidepool Loop. The document was automatically generated from Tidepool’s quality management system. The source documents are in Jira, our project management system. Information was pulled from these projects:
        • Tidepool Loop Functional Requirements - TLFR
        • Tidepool Loop Risks - TLR
        • Tidepool Loop Work Tickets - LOOP

        Tabs in this spreadsheet:
        • Traceability: This spreadsheet tab demonstrates traceability to and from all Tidepool Loop functional requirements. It has columns for each requirement, associated risks, design and development, verification tests, and test status.
        • For more information on Tidepool Loop’s requirements, please see Section 16 of the main pre-marketing notification document.
        • Hazard Analysis: This spreadsheet tab demonstrates Tidepool’s Risk and Hazard analysis of Tidepool Loop. Columns are included for each risk, including a summary, the potential harm and hazard category, risk assessment prior to mitigation, details of any mitigation, and risk assessment post-mitigation.
        
    requirements:
      name: Traceability
      aggregate_risks: true
      columns:
        - { width: 7,  key: req_id,          label: Req ID }
        - { width: 10, key: req_key,         label: Req Key }
        - { width: 50, key: req_summary,     label: Req Feature }
        - { width: 50, key: req_description, label: Req Description }
        - { width: 10, key: risk_key,        label: Risk Key }
        - { width: 50, key: risk_summary,    label: Hazardous Situation }
        - { width: 10, key: story_key,       label: Story Key }
        - { width: 50, key: story_summary,   label: Story Summary }
        - { width: 10, key: test_key,        label: Test Key }
        - { width: 50, key: test_summary,    label: Test Summary }
        - { width: 11, key: test_status,     label: Test Status }
    risks:
      name: Hazard Analysis
      columns:
        - { width: 10, key: risk_key,             label: Risk Key }
        - { width: 50, key: risk_summary,         label: Hazardous Situation }
        - { width: 30, key: sequence,             label: Sequence of Events }
        - { width: 25, key: harm,                 label: Harm }
        - { width: 13, key: hazard,               label: Hazard Category }
        - { width: 12, key: initial_severity,     label: Initial Severity }
        - { width: 12, key: initial_probability,  label: Initial Probability }
        - { width: 11, key: initial_risk,         label: Initial Risk Score }
        - { width: 10, key: mitigation_key,       label: Mitigation Key }
        - { width: 50, key: mitigation_summary,   label: Mitigation Summary }
        - { width: 12, key: residual_severity,    label: Residual Severity }
        - { width: 12, key: residual_probability, label: Residual Probability }
        - { width: 11, key: residual_risk,        label: Residual Risk Score }
        - { width: 10, key: benefit,              label: Benefit-Risk Analysis }
    epics:
      name: All Development Tickets
      columns:
        - { width: 10, key: epic_key,      label: Epic Key }
        - { width: 50, key: epic_sumamry,  label: Epic Summary }
        - { width: 10, key: story_key,     label: Story Key }
        - { width: 50, key: story_summary, label: Story Summary }
        - { width: 10, key: risk_key,      label: Risk Key }
        - { width: 50, key: risk_summary,  label: Hazardous Situation }
        - { width: 10, key: test_key,      label: Test Key }
        - { width: 50, key: test_summary,  label: Test Summary }
        - { width: 11, key: test_status,   label: Test Status }
  images:
    logo: templates/excel/Tidepool_Logo_Light_Large.png
  output:
    report: output/report.xlsx

graphviz:
  output:
    requirements:
      engine: dot
      format: svg
      graph: output/report_by_reqs
    epics:
      engine: dot
      format: svg
      graph: output/report_by_epics
